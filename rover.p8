pico-8 cartridge // http://www.pico-8.com
version 35
__lua__

local stars = {}
local terrain = {}

local sun = {}
sun.x = 20
sun.y = 20
sun.r = 10

local rover = {}
rover.x = 10
rover.y = 70
rover.xdir = 1
rover.ydir = 1
rover.spd = 0.25
rover.xacc = 0
rover.yacc = 0

local ani = {}
ani.t = 0

function _init()
	setup_stars()
	setup_terrain()
end

function _update()

 if rover.xacc > 0 then
		rover.xacc -= 0.25
	end
	
	if rover.yacc > 0 then
		rover.yacc -= 0.25
	end
	
	if rover.xacc > 5 then
		rover.xacc = 5
	end
	
	if rover.yacc > 5 then
		rover.yacc = 5
	end
	
	if btn(0, 0) then
		rover.xdir = -1
		rover.xacc += 0.5
	end
	
	if btn(1, 0) then
		rover.xdir = 1
		rover.xacc += 0.5
	end

	if btn(2, 0) then
		rover.ydir = -1
		rover.yacc += 0.5
	end
	
	if btn(3, 0) then
		rover.ydir = 1
		rover.yacc += 0.5
	end

	rover.x += rover.spd * rover.xacc * rover.xdir
	rover.y += rover.spd * rover.yacc * rover.ydir
	
	update_ani()
	
	if ani.t == 0 then
		setup_stars()
	end
end

function update_ani()
	ani.t += 1
	
	if ani.t > 50 then
		ani.t = 0
	end
end

function _draw()
	cls()

	draw_stars()
	draw_sun()

	
	rectfill(0, 64, 128, 128, 4)
	print("mars rover")
	
	draw_terrain()
		
	local flipx = rover.xdir < 0
	
	if rover.xacc > 0 or
		rover.yacc > 0 then
		local s = 1
		
		if ani.t % 2 == 0 then
			s = 2
		end
		
		spr(s, rover.x, rover.y, 1, 1, flipx)
	else
		spr(1, rover.x, rover.y, 1, 1, flipx)
	end
	
	
	if rover.xacc > 0 or
		rover.yacc > 0 then
		
		local s = 17
		
		if ani.t % 2 == 0 then
			s = 18
		end
		
		spr(s,
		 rover.x - (rover.xdir * 8),
		 rover.y,
		 1, 1, flipx)
	end
	
end

function draw_sun()
 circfill(sun.x, sun.y, sun.r + 2, 8)
	circfill(sun.x, sun.y, sun.r, 9)
end

function setup_stars()

	for i= 0, 100 do
		local r = rnd(128)
		stars[i] = {}
		stars[i].x = r
		stars[i].y = i
	end
end

function draw_stars()
	for i= 0, 100 do
		circfill(stars[i].x, 
		stars[i].y, 1, 7)
	end
end

function setup_terrain()
	for i= 0, 20 do
		terrain[i] = {}
		terrain[i].x = rnd(128) 
		terrain[i].y = rnd(60)+ 64
		terrain[i].spr = 33
	end

end

function draw_terrain()
	for i= 0, 20 do
		spr(terrain[i].spr, 
		terrain[i].x, 
		terrain[i].y)
	end
end
__gfx__
00000000000055500000555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000006000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000006000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000060000600600006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700050000505050050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555005550500005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000050000505050050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000500000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000050550550000005500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000d5050000d10500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001d005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000055dd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000005544dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000554444dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000005444444d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
